<div class="d-flex justify-content-end mb-3 gap-2">
  <button class="p-button p-button-success p-button-sm" (click)="expandAll()">Expandir todo</button>
  <button class="p-button p-button-warning p-button-sm" (click)="collapseAll()">Colapsar todo</button>
</div>

<p-table [value]="tablas" [tableStyle]="{ 'min-width': '60rem' }" class="p-datatable-striped p-datatable-hoverable">

  <!-- Cabecera principal -->
  <ng-template pTemplate="header">
    <tr>
      <th pSortableColumn="id">ID <p-sortIcon field="id"></p-sortIcon></th>
      <th pSortableColumn="nombre">Nombre <p-sortIcon field="nombre"></p-sortIcon></th>
      <th style="width: 5rem">Detalles</th>
    </tr>
  </ng-template>

  <!-- Cuerpo principal -->
  <ng-template pTemplate="body" let-client>
    <tr>
      <td>{{ client.id }}</td>
      <td>{{ client.nombre }}</td>
      <td>
        <button class="p-button p-button-secondary p-button-sm"
                (click)="client.expanded = !client.expanded">
          {{ client.expanded ? '-' : '+' }}
        </button>
      </td>
    </tr>

    <!-- Fila expandida -->
    <tr *ngIf="client.expanded">
      <td colspan="3">
        <div class="p-3 bg-light border rounded shadow-sm">
          <div class="d-flex flex-column gap-2">
            <div><strong>DNI:</strong> {{ client.dni }}</div>
            <div><strong>Dirección:</strong> {{ client.direccion || 'N/A' }}</div>
            <div>
              <strong>Teléfonos:</strong>
              <ul *ngIf="client.telefonos?.length > 0; else noTel">
                <li *ngFor="let t of client.telefonos">{{ t.numero }} ({{ t.type }})</li>
              </ul>
              <ng-template #noTel>No hay teléfonos</ng-template>
            </div>
          </div>
        </div>
      </td>
    </tr>
  </ng-template>

  <!-- Mensaje vacío -->
  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="3">No hay clientes para mostrar.</td>
    </tr>
  </ng-template>

</p-table>
