<div class="d-flex gap-2 align-items-center mb-3">
  <label><strong>A√±o:</strong></label>
  <p-select [options]="yearsOptions"
            [(ngModel)]="yearSeleccionado"
            (onChange)="onYearChange($event.value)">
  </p-select>

  <!-- üîΩ Bot√≥n de exportar a PDF -->
  <button 
    pButton 
    type="button" 
    label="Exportar PDF" 
    icon="pi pi-file-pdf" 
    class="p-button-danger p-button-raised p-button-sm"
    (click)="generarPDF()">
  </button>
</div>

<!-- Gr√°fica del hist√≥rico mensual -->
<div *ngIf="consumosFiltrados.length > 0; else noData">
<app-chart
  #consumoChartCanvas
  chartId="consumoChart"
  [chartType]="'line'"
  [chartData]="chartData"
  [chartOptions]="chartOptions">
</app-chart>


  <hr>

  <!-- Gr√°fica de estad√≠sticas anuales -->
  <div *ngIf="estadisticaActual">

<app-chart
  #estadisticaChartCanvas
  chartId="estadisticaChart"
  [chartType]="'bar'"
  [chartData]="chartDataEstadistica"
  [chartOptions]="chartOptionsEstadistica">
</app-chart>

  </div>

  <hr>

  <!-- Tabla -->
  <p-table [value]="consumosFiltrados" [tableStyle]="{ 'min-width': '30rem' }">
    <ng-template pTemplate="header">
      <tr>
        <th>A√±o</th>
        <th>Mes</th>
        <th>Total mensual (‚Ç¨)</th>
        <th>Eliminar</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-c>
      <tr>
        <td>{{ c.anio }}</td>
        <td>{{ getNombreMes(c.mes) }}</td>
        <td>{{ c.total_mensual }}</td>
        <td>
          <button 
            pButton 
            class="p-button-danger p-button-sm" 
            (click)="onDeleteConsumo(c.id)">
            <i class="pi pi-trash"></i>
          </button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<ng-template #noData>
  <p>No hay consumos registrados para este tel√©fono en este a√±o.</p>
</ng-template>

<hr>

<h5>A√±adir nuevo consumo</h5>
<div [formGroup]="formNuevoConsumo" class="d-flex gap-2 align-items-center mb-3">
  <p-select [options]="meses" placeholder="Mes" formControlName="mes"></p-select>
  <input pInputText type="number" formControlName="anio" placeholder="A√±o">
  <input pInputText type="number" formControlName="consumo" placeholder="Consumo (‚Ç¨)">
  <button 
    pButton 
    type="button" 
    class="p-button-success" 
    (click)="agregarConsumo()">
    <i class="pi pi-plus"></i> A√±adir
  </button>
</div>
